<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>traits - rust-training-aug19</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="affix"><a href="preface.html">Preface</a></li><li><a href="installation_win.html"><strong aria-hidden="true">1.</strong> Installation (Windows)</a></li><li><a href="anatomy.html"><strong aria-hidden="true">2.</strong> anatomy</a></li><li><a href="data_types.html"><strong aria-hidden="true">3.</strong> data types</a></li><li><a href="error_handling.html"><strong aria-hidden="true">4.</strong> error handling</a></li><li><a href="traits.html" class="active"><strong aria-hidden="true">5.</strong> traits</a></li><li><a href="external_dependencies.html"><strong aria-hidden="true">6.</strong> external dependencies</a></li><li><a href="enums.html"><strong aria-hidden="true">7.</strong> Enums and algebraic data types</a></li><li><a href="todo.html"><strong aria-hidden="true">8.</strong> borrow checker, scopes, raii, clone</a></li><li><a href="todo.html"><strong aria-hidden="true">9.</strong> code organization, modules</a></li><li><a href="control.html"><strong aria-hidden="true">10.</strong> Control Structures</a></li><li><a href="iterators.html"><strong aria-hidden="true">11.</strong> Iterators</a></li><li><a href="todo.html"><strong aria-hidden="true">12.</strong> rayon</a></li><li><a href="todo.html"><strong aria-hidden="true">13.</strong> Cross compiling for the linux arm target</a></li><li><a href="todo.html"><strong aria-hidden="true">14.</strong> FFI, calling C libraries, using unsafe Rust, and wrapper generation from C headers</a></li><li><a href="todo.html"><strong aria-hidden="true">15.</strong> type states</a></li><li><a href="todo.html"><strong aria-hidden="true">16.</strong> Generics, using strong types to avoid C and C++ weaknesses</a></li><li><a href="todo.html"><strong aria-hidden="true">17.</strong> networking, http? mqtt, changing states</a></li><li><a href="todo.html"><strong aria-hidden="true">18.</strong> macros struct op on top of our options struct</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">rust-training-aug19</h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#traits" id="traits">traits</a></h1>
<p>But hey this seems wordy, lets just print our whole struct in one formatter.</p>
<pre><code class="language-rust ignore no_run">//println!(
//    &quot;input_path:{} output_path:{}&quot;,
//    options.input_path, options.output_path
//);
println!(&quot;{}&quot;, options);
</code></pre>
<p>Running this results in:</p>
<pre><code class="language-text">error[E0277]: `Opt` doesn't implement `std::fmt::Display`
  --&gt; src/main.rs:14:20
   |
14 |     println!(&quot;{}&quot;, options);
   |                    ^^^^^^^ `Opt` cannot be formatted with the default formatter
   |
   = help: the trait `std::fmt::Display` is not implemented for `Opt`
   = note: in format strings you may be able to use `{:?}` (or {:#?} for pretty-print) instead
   = note: required by `std::fmt::Display::fmt`

error: aborting due to previous error

For more information about this error, try `rustc --explain E0277`.
error: Could not compile `training`.

To learn more, run the command again with --verbose.
</code></pre>
<p>Thats actually really rather helpful error with a several ideas for fixing it. AND in this case if say you're offline and can't google for more information it even has another page or two of content if you run the <code>rustc --explain E0277</code> command it mentions! </p>
<blockquote>
<p>The compiler in Rust is almost always, really, actually, trying to tell you whats wrong, AND how to fix it. And if you find a case where it is not the Rust community would likely want to know how to make that error and the resulting action you should take more clear. </p>
</blockquote>
<p>For this exercise we choose to manually implement the Display trait.</p>
<p>In Rust we stress composition over inheritance using <a href="https://doc.rust-lang.org/book/ch10-02-traits.html">traits</a>. Traits, much like header files, separate the definition from the implementation. Before we solve our actual Display problem by consuming someone else’s trait definition, lets make a convoluted example to illustrate the syntax. We'll make a silly trait that has one function so that <code>println!</code> SHOUTS our filenames.</p>
<pre><code class="language-rust ignore no_run">// create the new trait which has one function, shout
pub trait Shout {
    // we automatically get passed whatever variable function is called
    // on as the first argument to the function, we generally call it self
    fn shout(self);
}

// now implement the new trait you made
// since we're impl for Opt, self is an Opt and we have access to
// input_path and output_path
impl Shout for Opt {
    fn shout(self) {
        println!(
            &quot;{} {}&quot;,
            self.input_path.to_uppercase(),
            self.output_path.to_uppercase()
        );
    }
}
</code></pre>
<p>Now anytime this trait is in namespace, which in our case it is because it defined in this same file, it is available on all instances of Opt. Lets call it:</p>
<pre><code class="language-rust no_run ignore">//println!(&quot;{}&quot;, options);
options.shout();
</code></pre>
<p>and well should see something like</p>
<pre><code class="language-text">CAT.JPG TEST.PNG
</code></pre>
<blockquote>
<p>The separation of definition from implementation is incredibly powerful. This way if we make our trait public anyone downstream can customize our function for their architecture or edge case. This keeps Rust from amongst other things passing around huge config structs full of lifecycle callbacks and other configuration overrides.</p>
</blockquote>
<p>OK. So we can comment out our toy shout example and go back to fixing Display error. As a reminder it said</p>
<pre><code class="language-text">   = help: the trait `std::fmt::Display` is not implemented for `Opt`
</code></pre>
<p>Looking in the std documentation we find <a href="https://doc.rust-lang.org/std/fmt/trait.Display.html">Display</a> which shows us an example like below. Recall when we implement traits, the function definition was set in stone by the trait. In this case they pass us self (whatever type this method was called on, in this case Point, in our case Opt) and a second arg name f which well use the write! (just like <code>println!</code> except it sticks the output in its first argument) to print into.</p>
<p>Again we want to be able to call</p>
<pre><code class="language-rust ignore no_play">println!(&quot;{}&quot;, options);
</code></pre>
<p>My result looks like</p>
<pre><code class="language-text">(cat.jpg, test.png)
</code></pre>
<p>We're really only responsible for the returning something from the method. In the case of the Display trait that freedom largely pertains to the format string and which args we choose to print. So swap out these Point things for our Opt stuff.</p>
<pre><code class="language-rust ignore no_run">use std::fmt;

impl fmt::Display for Point {
    //Were still punting on the &amp; and &amp;mut but it doesn'nt matter here as the function definition is set in stone by the trait
    fn fmt(&amp;self, f: &amp;mut fmt::Formatter) -&gt; fmt::Result {
        write!(f, &quot;({}, {})&quot;, self.x, self.y) // notice no semicolon, were just passing the Result back
    }
}
</code></pre>
<p>And with that you've:</p>
<ul>
<li>created a new type and defined and implemented traits for it</li>
<li>implemented a trait you didn’t own.</li>
<li>but there's a third case you'll come across which is wanting to implement a trait you don't own on a type you don't own. </li>
</ul>
<blockquote>
<p>For various reasons, the compiler can't reason about these 'orphan rules' and doesn't allow them.  There are many ways around the limitation including forking the underlying crate and <a href="https://doc.rust-lang.org/cargo/reference/specifying-dependencies.html#overriding-dependencies">overriding dependencies</a> with Cargo patch functionality as well as the newtype pattern.</p>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="error_handling.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="external_dependencies.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="error_handling.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="external_dependencies.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        
        <script src="ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>
        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
